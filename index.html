<!DOCTYPE html>
<html lang="en">
    
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
        <title>Javascript Calculator</title>
        
        <!-- Fontawesome -->
        <script src="https://use.fontawesome.com/780ce05cc4.js"></script>
        
        <!-- Styles -->
        <link rel="stylesheet" href="style.css">
        
    </head>
    
    <body>
        
        <div class="container">
            <div class="calc-container">
                <div class="display">
                    <div class="result-container"><p class="result"></p></div>
                </div>
                <div class="breadcrumbs">
                    <div class="crumb-wrapper crumb-wrapper-0">
                    </div>
                </div>
                <div class="keypad">
                    <p class="button keypad-button one">1</p>
                    <p class="button keypad-button two">2</p>
                    <p class="button keypad-button three">3</p>
                    <p class="button keypad-button four">4</p>
                    <p class="button keypad-button five">5</p>
                    <p class="button keypad-button six">6</p>
                    <p class="button keypad-button seven">7</p>
                    <p class="button keypad-button eight">8</p>
                    <p class="button keypad-button nine">9</p>
                    <p class="button keypad-button percent">&percnt;</p>
                    <p class="button keypad-button zero">0</p>
                    <p class="button keypad-button period">&period;</p>
                </div>
                <div class="operators">
                    <p class="button operator-button divide">&div;</p>
                    <p class="button operator-button minus">&minus;</p>
                    <p class="button operator-button plus">&plus;</p>
                    <p class="button operator-button times">&times;</p>
                </div>
                <div class="back-eval">
                    <p class="button back-eval-button back">&lt; Back</p>
                    <p class="button back-eval-button evaluate">&equals;</p>
                </div>
            </div>
        </div>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        
        <script type="text/javascript">
            
            window.onload = function() {
                
                var id;
                var equalClicks = 0;
                console.log("Equal button clicks: " + equalClicks);
                
                var expression = ""; // initialize expression
                var breadcrumb = ""; // initialize breadcrumb
                
                // update expression on click
                $(".one").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".two").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".three").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".four").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".five").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".six").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".seven").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".eight").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".nine").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".percent").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".zero").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".period").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".divide").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".minus").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".plus").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                $(".times").click(function() {
                    console.log($(this).text());
                    expression = expression + $(this).text();
                    breadcrumb = breadcrumb + $(this).text();
                    addCrumb();
                });
                
                // add breadcrumbs
                function addCrumb() {
                    $(".crumb-wrapper-" + equalClicks).css("display", "flex");
                    console.log("add breadcrumb: " + breadcrumb);
                    var html = "";
                    for (i=0; i<breadcrumb.length; i++) {
                        html = html + "<div class='crumb'>" + breadcrumb[i] + "</div>"
                    }
                    console.log(html);
                    $(".crumb-wrapper-" + equalClicks).html(html);
                }
                
                function evaluate(str) {
                    try {
                        return eval(str);
                    } catch (e) {
                        if (e instanceof SyntaxError) {
                            alert(e.message);
                            $(".result").empty().html("error");
                        }
                    }
                }
                
                // evaluate expression
                $(".evaluate").click(function() {
                    console.log("evaluate");
                    console.log(expression);
                    
                    // increment the number of equal clicks by one
                    equalClicks++;
                    console.log("Equal button clicks: " + equalClicks);
                    
                    // evaluate the expression and display it
                    $(".result").empty().html(evaluate(expression));
                    breadcrumb = ""; // reset breadcrumb
                    
                    // add new breadcrumb div to accept the next breadcrumb
                    $(".breadcrumbs").append("<div class='crumb-wrapper crumb-wrapper-" + equalClicks + "'></div>"); 
                    $(".crumb-wrapper-" + equalClicks).css({"display":"none", "background-color":"#68cef2"});
                });
                
                // go back
                $(".back").click(function() {
                    
                    // if equal was clicked before going back, remove the blank div added by clicking on equal
                    if ($(".crumb-wrapper-" + equalClicks).text() == "") {
                        // remove most recent breadcrumb
                        $(".crumb-wrapper-" + equalClicks).remove();
                        // decrement the number of equal clicks by 1
                        equalClicks--;
                    }
                    
                    console.log($(".crumb-wrapper-" + equalClicks));
                    
                    // remove the most recent breadcrumb
                    $(".crumb-wrapper-" + equalClicks).remove();
                    
                    // reset the expression
                    var lastExpression = [];
                    $('.crumb').each(function() {
                       lastExpression.push($(this).text());
                    });
                    expression = lastExpression.join("");
                    
                    // evaluate the expression and display it
                    $(".result").empty().html(evaluate(expression));
                    breadcrumb = ""; // reset breadcrumb
                    
                    // add new breadcrumb div to accept the next breadcrumb
                    $(".breadcrumbs").append("<div class='crumb-wrapper crumb-wrapper-" + equalClicks + "'></div>"); 
                    $(".crumb-wrapper-" + equalClicks).css({"display":"none", "background-color":"#68cef2"});
                    
                    console.log("You have moved back one step");
                    console.log("Equal clicks have been reset to " + equalClicks);
                    console.log("The expression to be evaluated has been reset to: " + lastExpression);
                    
                });

            }
            
        </script>
        
    </body>
    
</html>